<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ãƒ•ãƒ©ãƒƒã‚·ãƒ¥æ•°å­—è¨˜æ†¶ã‚²ãƒ¼ãƒ </title>

<style>
/* ===== å…¨ä½“ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ ===== */
body {
    margin: 0;
    height: 100vh;
    font-family: "Segoe UI", sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    background: linear-gradient(135deg, #6a11cb, #2575fc);
}

/* ä¸­å¤®ã‚«ãƒ¼ãƒ‰ */
.card {
    background: white;
    width: 420px;
    padding: 20px;
    border-radius: 16px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0,0,0,0.2);
}

/* ã‚¿ã‚¤ãƒˆãƒ« */
h1 {
    margin-top: 0;
}

/* å¤§ããªè¡¨ç¤ºç”¨ï¼ˆã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ãƒ»ãƒ•ãƒ©ãƒƒã‚·ãƒ¥æ•°å­—ï¼‰ */
.big-number {
    font-size: 8em;
    font-weight: bold;
    margin: 20px 0;
    animation: pop 0.3s ease;
}

/* æ•°å­—ãŒå°‘ã—ãƒãƒƒãƒ—ã™ã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
@keyframes pop {
    0% { transform: scale(0.8); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
}

/* éè¡¨ç¤º */
.hidden {
    display: none;
}

/* ã‚»ãƒ¬ã‚¯ãƒˆãƒ»ãƒœã‚¿ãƒ³å…±é€š */
select, button {
    padding: 10px 16px;
    font-size: 16px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    margin: 5px;
}

/* ã‚¹ã‚¿ãƒ¼ãƒˆãƒœã‚¿ãƒ³ */
.start-btn {
    background: #2575fc;
    color: white;
}

/* æ•°å­—ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ */
.number-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    margin-top: 15px;
}

/* æ•°å­—ãƒœã‚¿ãƒ³ */
.number-btn {
    font-size: 24px;
    padding: 15px;
    border-radius: 12px;
    background: #f0f0f0;
    transition: transform 0.2s, box-shadow 0.2s;
}

/* hoveræ™‚ã«æµ®ãä¸ŠãŒã‚‹ */
.number-btn:hover:not(:disabled) {
    transform: translateY(-4px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.2);
}

/* æŠ¼ã›ãªããªã£ãŸãƒœã‚¿ãƒ³ */
.number-btn:disabled {
    background: #ccc;
    cursor: not-allowed;
}

/* å…¥åŠ›é †è¡¨ç¤º */
.sequence-display {
    margin-top: 10px;
    min-height: 24px;
}

/* çµæœè¡¨ç¤º */
.result {
    font-size: 24px;
    padding: 15px;
    border-radius: 12px;
    margin-top: 15px;
}

/* æ­£è§£ */
.success {
    background: #d4f7d4;
    color: #2e7d32;
}

/* ä¸æ­£è§£ */
.fail {
    background: #ffd6d6;
    color: #c62828;
}

/* ä¸‹éƒ¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ */
.stats {
    margin-top: 15px;
    font-size: 14px;
}
</style>
</head>

<body>
<div class="card">

    <h1>ğŸ§  ãƒ•ãƒ©ãƒƒã‚·ãƒ¥æ•°å­—è¨˜æ†¶</h1>

    <!-- è¨­å®šç”»é¢ -->
    <div id="setup">
        <select id="difficulty">
            <option value="easy">ç°¡å˜</option>
            <option value="normal">æ™®é€š</option>
            <option value="hard">é›£ã—ã„</option>
            <option value="veryhard">è¶…é›£ã—ã„</option>
        </select>
        <br>
        <button class="start-btn" onclick="startGame()">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
    </div>

    <!-- ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ãƒ»æ•°å­—è¡¨ç¤º -->
    <div id="display" class="big-number hidden"></div>

    <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›è¡¨ç¤º -->
    <div id="userSequence" class="sequence-display"></div>

    <!-- æ•°å­—ãƒœã‚¿ãƒ³ -->
    <div id="numberGrid" class="number-grid hidden"></div>

    <!-- çµæœ -->
    <div id="result" class="result hidden"></div>

    <!-- å†ãƒ—ãƒ¬ã‚¤ -->
    <div id="control" class="hidden">
        <button onclick="resetGame()">ã‚‚ã†ä¸€åº¦</button>
        <button onclick="location.reload()">çµ‚äº†</button>
    </div>

    <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ -->
    <div class="stats">
        é€£ç¶šæˆåŠŸ: <span id="streak">0</span> /
        æœ€é«˜è¨˜éŒ²: <span id="best">0</span> /
        æ­£è§£ç‡: <span id="rate">0</span>%
    </div>

</div>

<script>
/* ===============================
   ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
================================ */

// æ­£è§£ã®é †ç•ª
let correctSequence = [];

// ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›é †
let userSequence = [];

// ã‚¯ãƒªãƒƒã‚¯å›æ•°ç®¡ç†
let clickCount = 0;

// é€£ç¶šæˆåŠŸãƒ»æœ€é«˜è¨˜éŒ²
let streak = 0;
let best = 0;

// ç·ãƒ—ãƒ¬ã‚¤æ•°ãƒ»æˆåŠŸæ•°
let totalPlay = 0;
let totalSuccess = 0;

/* ===============================
   ã‚²ãƒ¼ãƒ é–‹å§‹
================================ */
function startGame() {
    document.getElementById("setup").classList.add("hidden");
    startCountdown(3);
}

/* ===============================
   ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³è¡¨ç¤º
================================ */
function startCountdown(count) {
    const display = document.getElementById("display");
    display.classList.remove("hidden");
    display.textContent = count;

    if (count > 1) {
        setTimeout(() => startCountdown(count - 1), 1000);
    } else {
        setTimeout(() => {
            display.classList.add("hidden");
            startFlash();
        }, 1000);
    }
}

/* ===============================
   ãƒ•ãƒ©ãƒƒã‚·ãƒ¥æ•°å­—é–‹å§‹
================================ */
function startFlash() {
    const difficulty = document.getElementById("difficulty").value;

    // é›£æ˜“åº¦è¨­å®š
    let settings = {
        easy:      { count: 3, speed: 1000 },
        normal:    { count: 5, speed: 700 },
        hard:      { count: 7, speed: 500 },
        veryhard:  { count: 9, speed: 400 }
    };

    // 1ã€œ9ã®é…åˆ—ã‚’ã‚·ãƒ£ãƒƒãƒ•ãƒ«
    let numbers = [1,2,3,4,5,6,7,8,9];
    numbers.sort(() => Math.random() - 0.5);

    // å¿…è¦ãªå€‹æ•°ã ã‘å–å¾—
    correctSequence = numbers.slice(0, settings[difficulty].count);

    showNumberSequence(correctSequence, settings[difficulty].speed);
}

/* ===============================
   æ•°å­—ã‚’é †ç•ªã«è¡¨ç¤º
================================ */
function showNumberSequence(sequence, speed) {
    let index = 0;
    const display = document.getElementById("display");
    display.classList.remove("hidden");

    const interval = setInterval(() => {
        display.textContent = sequence[index];
        index++;

        if (index >= sequence.length) {
            clearInterval(interval);
            setTimeout(() => {
                display.classList.add("hidden");
                showNumberButtons();
            }, speed);
        }
    }, speed);
}

/* ===============================
   æ•°å­—ãƒœã‚¿ãƒ³è¡¨ç¤º
================================ */
function showNumberButtons() {
    const grid = document.getElementById("numberGrid");
    grid.innerHTML = "";
    grid.classList.remove("hidden");

    userSequence = [];
    clickCount = 0;
    document.getElementById("userSequence").textContent = "";

    // 1ã€œ9ã®ãƒœã‚¿ãƒ³ç”Ÿæˆ
    for (let i = 1; i <= 9; i++) {
        const btn = document.createElement("button");
        btn.textContent = i;
        btn.className = "number-btn";
        btn.onclick = () => selectNumber(i, btn);
        grid.appendChild(btn);
    }
}

/* ===============================
   æ•°å­—é¸æŠ
================================ */
function selectNumber(num, button) {
    userSequence.push(num);
    button.disabled = true;

    // å…¥åŠ›é †ã‚’è¡¨ç¤º
    document.getElementById("userSequence").textContent =
        userSequence.join(" â†’ ");

    clickCount++;

    // å¿…è¦æ•°ã‚¯ãƒªãƒƒã‚¯ã—ãŸã‚‰åˆ¤å®š
    if (clickCount === correctSequence.length) {
        submitAnswer();
    }
}

/* ===============================
   åˆ¤å®šå‡¦ç†
================================ */
function submitAnswer() {
    totalPlay++;

    const result = document.getElementById("result");
    result.classList.remove("hidden");

    if (JSON.stringify(correctSequence) === JSON.stringify(userSequence)) {
        streak++;
        totalSuccess++;
        best = Math.max(best, streak);

        result.className = "result success";
        result.innerHTML = "ğŸ‰ æ­£è§£ï¼<br>æ­£è§£é †: " + correctSequence.join(" â†’ ");
    } else {
        streak = 0;
        result.className = "result fail";
        result.innerHTML =
            "âŒ æ®‹å¿µï¼<br>" +
            "æ­£è§£: " + correctSequence.join(" â†’ ") + "<br>" +
            "ã‚ãªãŸ: " + userSequence.join(" â†’ ");
    }

    updateStats();
    document.getElementById("control").classList.remove("hidden");
}

/* ===============================
   ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
================================ */
function updateStats() {
    document.getElementById("streak").textContent = streak;
    document.getElementById("best").textContent = best;
    document.getElementById("rate").textContent =
        Math.round((totalSuccess / totalPlay) * 100);
}

/* ===============================
   ãƒªã‚»ãƒƒãƒˆ
================================ */
function resetGame() {
    document.getElementById("setup").classList.remove("hidden");
    document.getElementById("numberGrid").classList.add("hidden");
    document.getElementById("result").classList.add("hidden");
    document.getElementById("control").classList.add("hidden");
}
</script>
</body>
</html>
